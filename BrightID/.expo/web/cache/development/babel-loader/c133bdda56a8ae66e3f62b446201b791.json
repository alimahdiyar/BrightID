{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.linkSocialMediaApp = linkSocialMediaApp;\nexports.syncAndLinkSocialMedias = exports.setSyncSocialMediaEnabledThunk = exports.saveAndLinkSocialMedia = exports.removeSocialMediaThunk = exports.removeSocialFromServer = exports.removeAllSocialMediasFromServer = void 0;\nexports.syncSocialMedia = syncSocialMedia;\nexports.updateSocialMediaVariations = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _ramda = require(\"ramda\");\n\nvar _socialMediaService = require(\"../../api/socialMediaService\");\n\nvar _model = require(\"../Apps/model\");\n\nvar _store = _interopRequireDefault(require(\"../../store\"));\n\nvar _appsSlice = require(\"../../reducer/appsSlice\");\n\nvar _socialMediaSlice = require(\"../../reducer/socialMediaSlice\");\n\nvar _socialMediaVariationSlice = require(\"../../reducer/socialMediaVariationSlice\");\n\nvar _socialUtils = require(\"../../utils/socialUtils\");\n\nvar _constants = require(\"../../utils/constants\");\n\nvar _settingsSlice = require(\"../../reducer/settingsSlice\");\n\nvar _types = require(\"../Apps/types.d\");\n\nvar _socialMediaServiceProvider = _interopRequireDefault(require(\"../../utils/socialMediaServiceProvider\"));\n\nfunction linkSocialMediaApp(appId, appUserId) {\n  var linked, apps, appInfo, signedTimestamp;\n  return _regenerator.default.async(function linkSocialMediaApp$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          linked = false;\n          apps = (0, _appsSlice.selectAllApps)(_store.default.getState());\n          appInfo = (0, _ramda.find)((0, _ramda.propEq)('id', appId))(apps);\n\n          if (!(appInfo && appInfo.usingBlindSig)) {\n            _context.next = 15;\n            break;\n          }\n\n          signedTimestamp = (0, _model.getSignedTimestamp)(appInfo);\n\n          if (!(signedTimestamp && Date.now() - signedTimestamp > _constants.SOCIAL_MEDIA_SIG_WAIT_TIME)) {\n            _context.next = 15;\n            break;\n          }\n\n          _context.prev = 6;\n          _context.next = 9;\n          return _regenerator.default.awrap((0, _model.linkAppId)(appId, appUserId, true));\n\n        case 9:\n          linked = _context.sent;\n          _context.next = 15;\n          break;\n\n        case 12:\n          _context.prev = 12;\n          _context.t0 = _context[\"catch\"](6);\n          console.log(_context.t0);\n\n        case 15:\n          return _context.abrupt(\"return\", linked);\n\n        case 16:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, [[6, 12]], Promise);\n}\n\nfunction syncSocialMedia(token, incomingSocialMedia, socialMediaVariation) {\n  var _incomingSocialMedia$;\n\n  var synced, appUserId, profileHashes, data;\n  return _regenerator.default.async(function syncSocialMedia$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          synced = false;\n          appUserId = ((_incomingSocialMedia$ = incomingSocialMedia.brightIdSocialAppData) == null ? void 0 : _incomingSocialMedia$.appUserId) || null;\n          profileHashes = (0, _socialUtils.generateSocialProfileHashes)(incomingSocialMedia.profile, socialMediaVariation.id);\n\n          if (!token) {\n            _context2.next = 17;\n            break;\n          }\n\n          _context2.prev = 4;\n          _context2.next = 7;\n          return _regenerator.default.awrap(_socialMediaServiceProvider.default.updateSocialMedia({\n            token: token,\n            profileHashes: profileHashes\n          }));\n\n        case 7:\n          synced = true;\n          _context2.next = 15;\n          break;\n\n        case 10:\n          _context2.prev = 10;\n          _context2.t0 = _context2[\"catch\"](4);\n\n          if (!(_context2.t0.message === _socialMediaService.SOCIAL_API_AUTHENTICATION_ERROR)) {\n            _context2.next = 14;\n            break;\n          }\n\n          return _context2.abrupt(\"return\", syncSocialMedia(null, incomingSocialMedia, socialMediaVariation));\n\n        case 14:\n          console.log(_context2.t0);\n\n        case 15:\n          _context2.next = 29;\n          break;\n\n        case 17:\n          _context2.prev = 17;\n          _context2.next = 20;\n          return _regenerator.default.awrap(_socialMediaServiceProvider.default.createSocialMedia({\n            profileHashes: profileHashes,\n            variation: socialMediaVariation.id,\n            network: __DEV__ ? _types.BrightIdNetwork.TEST : _types.BrightIdNetwork.NODE\n          }));\n\n        case 20:\n          data = _context2.sent;\n          token = data.token;\n          appUserId = data.appUserId;\n          synced = true;\n          _context2.next = 29;\n          break;\n\n        case 26:\n          _context2.prev = 26;\n          _context2.t1 = _context2[\"catch\"](17);\n          console.log(_context2.t1);\n\n        case 29:\n          return _context2.abrupt(\"return\", {\n            token: token,\n            appUserId: appUserId,\n            synced: synced\n          });\n\n        case 30:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, [[4, 10], [17, 26]], Promise);\n}\n\nvar saveAndLinkSocialMedia = function saveAndLinkSocialMedia(incomingSocialMedia) {\n  return function _callee(dispatch, getState) {\n    var prevProfile, syncSocialMediaEnabled, socialMediaVariation, brightIdSocialAppData, synced, token, appUserId, linked, __ret, appId, socialMedia;\n\n    return _regenerator.default.async(function _callee$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            prevProfile = (0, _socialMediaSlice.selectSocialMediaById)(getState(), incomingSocialMedia.id);\n            dispatch((0, _socialMediaSlice.saveSocialMedia)(incomingSocialMedia));\n            syncSocialMediaEnabled = (0, _settingsSlice.selectSyncSocialMediaEnabled)(getState());\n\n            if (syncSocialMediaEnabled) {\n              _context3.next = 5;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", incomingSocialMedia);\n\n          case 5:\n            socialMediaVariation = (0, _socialMediaVariationSlice.selectSocialMediaVariationById)(getState(), incomingSocialMedia.id);\n            brightIdSocialAppData = (0, _extends2.default)({\n              synced: false,\n              linked: false,\n              appUserId: null,\n              token: null\n            }, incomingSocialMedia.brightIdSocialAppData);\n            synced = brightIdSocialAppData.synced, token = brightIdSocialAppData.token, appUserId = brightIdSocialAppData.appUserId, linked = brightIdSocialAppData.linked;\n\n            if (!(!synced || (prevProfile == null ? void 0 : prevProfile.profile) !== incomingSocialMedia.profile)) {\n              _context3.next = 15;\n              break;\n            }\n\n            _context3.next = 11;\n            return _regenerator.default.awrap(syncSocialMedia(token, incomingSocialMedia, socialMediaVariation));\n\n          case 11:\n            __ret = _context3.sent;\n            token = __ret.token;\n            appUserId = __ret.appUserId;\n            synced = __ret.synced;\n\n          case 15:\n            if (!(synced && !linked)) {\n              _context3.next = 21;\n              break;\n            }\n\n            appId = socialMediaVariation.brightIdAppId;\n\n            if (!appId) {\n              _context3.next = 21;\n              break;\n            }\n\n            _context3.next = 20;\n            return _regenerator.default.awrap(linkSocialMediaApp(appId, appUserId));\n\n          case 20:\n            linked = _context3.sent;\n\n          case 21:\n            socialMedia = (0, _extends2.default)({}, incomingSocialMedia, {\n              brightIdSocialAppData: {\n                synced: synced,\n                token: token,\n                appUserId: appUserId,\n                linked: linked\n              }\n            });\n            dispatch((0, _socialMediaSlice.saveSocialMedia)(socialMedia));\n            return _context3.abrupt(\"return\", socialMedia);\n\n          case 24:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\n\nexports.saveAndLinkSocialMedia = saveAndLinkSocialMedia;\n\nvar removeSocialFromServer = function _callee2(socialMedia) {\n  var _socialMedia$brightId;\n\n  return _regenerator.default.async(function _callee2$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          if (!((_socialMedia$brightId = socialMedia.brightIdSocialAppData) != null && _socialMedia$brightId.token)) {\n            _context4.next = 10;\n            break;\n          }\n\n          _context4.prev = 1;\n          _context4.next = 4;\n          return _regenerator.default.awrap(_socialMediaServiceProvider.default.deleteSocialMediaProfile(socialMedia.brightIdSocialAppData.token));\n\n        case 4:\n          _context4.next = 10;\n          break;\n\n        case 6:\n          _context4.prev = 6;\n          _context4.t0 = _context4[\"catch\"](1);\n\n          if (!(_context4.t0.message !== _socialMediaService.SOCIAL_API_AUTHENTICATION_ERROR)) {\n            _context4.next = 10;\n            break;\n          }\n\n          throw _context4.t0;\n\n        case 10:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, null, null, [[1, 6]], Promise);\n};\n\nexports.removeSocialFromServer = removeSocialFromServer;\n\nvar removeSocialMediaThunk = function removeSocialMediaThunk(id) {\n  return function _callee3(dispatch, getState) {\n    var prevProfile, socialMedia;\n    return _regenerator.default.async(function _callee3$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            prevProfile = (0, _socialMediaSlice.selectSocialMediaById)(getState(), id);\n\n            if (!prevProfile) {\n              _context5.next = 6;\n              break;\n            }\n\n            _context5.next = 4;\n            return _regenerator.default.awrap(removeSocialFromServer(prevProfile));\n\n          case 4:\n            socialMedia = (0, _extends2.default)({}, prevProfile, {\n              profile: null\n            });\n            dispatch((0, _socialMediaSlice.saveSocialMedia)(socialMedia));\n\n          case 6:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\n\nexports.removeSocialMediaThunk = removeSocialMediaThunk;\n\nvar updateSocialMediaVariations = function updateSocialMediaVariations() {\n  return function _callee4(dispatch, getState) {\n    var socialMediaVariations;\n    return _regenerator.default.async(function _callee4$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            _context6.next = 2;\n            return _regenerator.default.awrap(_socialMediaServiceProvider.default.retrieveSocialMediaVariations());\n\n          case 2:\n            socialMediaVariations = _context6.sent;\n            dispatch((0, _socialMediaVariationSlice.upsertSocialMediaVariations)(socialMediaVariations));\n\n          case 4:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\n\nexports.updateSocialMediaVariations = updateSocialMediaVariations;\n\nvar syncAndLinkSocialMedias = function syncAndLinkSocialMedias() {\n  return function _callee5(dispatch, getState) {\n    var socialMedias;\n    return _regenerator.default.async(function _callee5$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            socialMedias = (0, _socialMediaSlice.selectAllSocialMedia)(getState());\n            socialMedias.forEach(function (socialMedia) {\n              if (socialMedia.profile) {\n                dispatch(saveAndLinkSocialMedia(socialMedia));\n              }\n            });\n\n          case 2:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\n\nexports.syncAndLinkSocialMedias = syncAndLinkSocialMedias;\n\nvar removeAllSocialMediasFromServer = function removeAllSocialMediasFromServer() {\n  return function _callee6(dispatch, getState) {\n    var socialMedias, i, socialMedia, newSocialMedia;\n    return _regenerator.default.async(function _callee6$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            socialMedias = (0, _socialMediaSlice.selectAllSocialMedia)(getState());\n            i = 0;\n\n          case 2:\n            if (!(i < socialMedias.length)) {\n              _context8.next = 12;\n              break;\n            }\n\n            socialMedia = socialMedias[i];\n\n            if (!socialMedia.profile) {\n              _context8.next = 9;\n              break;\n            }\n\n            _context8.next = 7;\n            return _regenerator.default.awrap(removeSocialFromServer(socialMedia));\n\n          case 7:\n            newSocialMedia = (0, _extends2.default)({}, socialMedia, {\n              brightIdSocialAppData: (0, _extends2.default)({}, socialMedia.brightIdSocialAppData, {\n                synced: false\n              })\n            });\n            dispatch((0, _socialMediaSlice.saveSocialMedia)(newSocialMedia));\n\n          case 9:\n            i++;\n            _context8.next = 2;\n            break;\n\n          case 12:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\n\nexports.removeAllSocialMediasFromServer = removeAllSocialMediasFromServer;\n\nvar setSyncSocialMediaEnabledThunk = function setSyncSocialMediaEnabledThunk(value) {\n  return function _callee7(dispatch, getState) {\n    var prevState;\n    return _regenerator.default.async(function _callee7$(_context9) {\n      while (1) {\n        switch (_context9.prev = _context9.next) {\n          case 0:\n            prevState = (0, _settingsSlice.selectSyncSocialMediaEnabled)(getState());\n            dispatch((0, _settingsSlice.setSyncSocialMediaEnabled)(value));\n            _context9.prev = 2;\n\n            if (!value) {\n              _context9.next = 8;\n              break;\n            }\n\n            _context9.next = 6;\n            return _regenerator.default.awrap(dispatch(syncAndLinkSocialMedias()));\n\n          case 6:\n            _context9.next = 10;\n            break;\n\n          case 8:\n            _context9.next = 10;\n            return _regenerator.default.awrap(dispatch(removeAllSocialMediasFromServer()));\n\n          case 10:\n            _context9.next = 15;\n            break;\n\n          case 12:\n            _context9.prev = 12;\n            _context9.t0 = _context9[\"catch\"](2);\n            dispatch((0, _settingsSlice.setSyncSocialMediaEnabled)(prevState));\n\n          case 15:\n          case \"end\":\n            return _context9.stop();\n        }\n      }\n    }, null, null, [[2, 12]], Promise);\n  };\n};\n\nexports.setSyncSocialMediaEnabledThunk = setSyncSocialMediaEnabledThunk;","map":{"version":3,"names":["linkSocialMediaApp","appId","appUserId","linked","apps","selectAllApps","store","getState","appInfo","find","propEq","usingBlindSig","signedTimestamp","getSignedTimestamp","Date","now","SOCIAL_MEDIA_SIG_WAIT_TIME","linkAppId","console","log","syncSocialMedia","token","incomingSocialMedia","socialMediaVariation","synced","brightIdSocialAppData","profileHashes","generateSocialProfileHashes","profile","id","socialMediaService","updateSocialMedia","message","SOCIAL_API_AUTHENTICATION_ERROR","createSocialMedia","variation","network","__DEV__","BrightIdNetwork","TEST","NODE","data","saveAndLinkSocialMedia","dispatch","prevProfile","selectSocialMediaById","saveSocialMedia","syncSocialMediaEnabled","selectSyncSocialMediaEnabled","selectSocialMediaVariationById","__ret","brightIdAppId","socialMedia","removeSocialFromServer","deleteSocialMediaProfile","removeSocialMediaThunk","updateSocialMediaVariations","retrieveSocialMediaVariations","socialMediaVariations","upsertSocialMediaVariations","syncAndLinkSocialMedias","socialMedias","selectAllSocialMedia","forEach","removeAllSocialMediasFromServer","i","length","newSocialMedia","setSyncSocialMediaEnabledThunk","value","prevState","setSyncSocialMediaEnabled"],"sources":["/home/ali/Desktop/brightid/BrightID/BrightID/src/components/EditProfile/socialMediaThunks.ts"],"sourcesContent":["import { find, propEq } from 'ramda';\nimport { SOCIAL_API_AUTHENTICATION_ERROR } from '@/api/socialMediaService';\nimport { getSignedTimestamp, linkAppId } from '@/components/Apps/model';\nimport store from '@/store';\nimport { selectAllApps } from '@/reducer/appsSlice';\nimport {\n  saveSocialMedia,\n  selectAllSocialMedia,\n  selectSocialMediaById,\n} from '@/reducer/socialMediaSlice';\nimport {\n  selectSocialMediaVariationById,\n  upsertSocialMediaVariations,\n} from '@/reducer/socialMediaVariationSlice';\nimport { generateSocialProfileHashes } from '@/utils/socialUtils';\nimport { SOCIAL_MEDIA_SIG_WAIT_TIME } from '@/utils/constants';\nimport {\n  selectSyncSocialMediaEnabled,\n  setSyncSocialMediaEnabled,\n} from '@/reducer/settingsSlice';\nimport { BrightIdNetwork } from '@/components/Apps/types.d';\nimport socialMediaService from '@/utils/socialMediaServiceProvider';\n\nexport async function linkSocialMediaApp(appId: string, appUserId: string) {\n  let linked = false;\n  const apps = selectAllApps(store.getState());\n  const appInfo = find(propEq('id', appId))(apps) as AppInfo;\n  if (appInfo && appInfo.usingBlindSig) {\n    const signedTimestamp = getSignedTimestamp(appInfo);\n    if (\n      signedTimestamp &&\n      Date.now() - signedTimestamp > SOCIAL_MEDIA_SIG_WAIT_TIME\n    ) {\n      try {\n        linked = await linkAppId(appId, appUserId, true);\n      } catch (e) {\n        console.log(e);\n      }\n    }\n  }\n  return linked;\n}\n\nexport async function syncSocialMedia(\n  token: string,\n  incomingSocialMedia: SocialMedia,\n  socialMediaVariation: SocialMediaVariation,\n) {\n  let synced = false;\n  let appUserId = incomingSocialMedia.brightIdSocialAppData?.appUserId || null;\n  const profileHashes = generateSocialProfileHashes(\n    incomingSocialMedia.profile,\n    socialMediaVariation.id,\n  );\n  if (token) {\n    try {\n      await socialMediaService.updateSocialMedia({\n        token,\n        profileHashes,\n      });\n      synced = true;\n    } catch (e) {\n      if (e.message === SOCIAL_API_AUTHENTICATION_ERROR) {\n        return syncSocialMedia(null, incomingSocialMedia, socialMediaVariation);\n      }\n      console.log(e);\n    }\n  } else {\n    try {\n      const data = await socialMediaService.createSocialMedia({\n        profileHashes,\n        variation: socialMediaVariation.id,\n        network: __DEV__ ? BrightIdNetwork.TEST : BrightIdNetwork.NODE,\n      });\n      token = data.token;\n      appUserId = data.appUserId;\n      synced = true;\n    } catch (e) {\n      console.log(e);\n    }\n  }\n  return { token, appUserId, synced };\n}\n\nexport const saveAndLinkSocialMedia =\n  (incomingSocialMedia: SocialMedia) =>\n  async (dispatch: dispatch, getState: getState) => {\n    const prevProfile = selectSocialMediaById(\n      getState(),\n      incomingSocialMedia.id,\n    );\n\n    // First, update locally, so the user doesn't need to wait for\n    // the server to complete the request to see his new profile in the UI.\n    dispatch(saveSocialMedia(incomingSocialMedia));\n    const syncSocialMediaEnabled = selectSyncSocialMediaEnabled(getState());\n    if (!syncSocialMediaEnabled) {\n      return incomingSocialMedia;\n    }\n    const socialMediaVariation = selectSocialMediaVariationById(\n      getState(),\n      incomingSocialMedia.id,\n    );\n    const brightIdSocialAppData: BrightIdSocialAppData = {\n      synced: false,\n      linked: false,\n      appUserId: null,\n      token: null,\n      ...incomingSocialMedia.brightIdSocialAppData,\n    };\n    let { synced, token, appUserId, linked } = brightIdSocialAppData;\n\n    if (!synced || prevProfile?.profile !== incomingSocialMedia.profile) {\n      const __ret = await syncSocialMedia(\n        token,\n        incomingSocialMedia,\n        socialMediaVariation,\n      );\n      token = __ret.token;\n      appUserId = __ret.appUserId;\n      synced = __ret.synced;\n    }\n\n    if (synced && !linked) {\n      const appId = socialMediaVariation.brightIdAppId;\n      if (appId) {\n        linked = await linkSocialMediaApp(appId, appUserId);\n      }\n    }\n\n    const socialMedia: SocialMedia = {\n      ...incomingSocialMedia,\n      brightIdSocialAppData: { synced, token, appUserId, linked },\n    };\n    dispatch(saveSocialMedia(socialMedia));\n    return socialMedia;\n  };\n\nexport const removeSocialFromServer = async (socialMedia: SocialMedia) => {\n  if (socialMedia.brightIdSocialAppData?.token) {\n    try {\n      await socialMediaService.deleteSocialMediaProfile(\n        socialMedia.brightIdSocialAppData.token,\n      );\n    } catch (e) {\n      // if the token by some reason doesn't exist on the server, so\n      // there is nothing to delete, so ignore the error.\n      if (e.message !== SOCIAL_API_AUTHENTICATION_ERROR) {\n        throw e;\n      }\n    }\n  }\n};\n\nexport const removeSocialMediaThunk =\n  (id: string) => async (dispatch: dispatch, getState: getState) => {\n    const prevProfile = selectSocialMediaById(getState(), id);\n    if (prevProfile) {\n      await removeSocialFromServer(prevProfile);\n      const socialMedia: SocialMedia = {\n        ...prevProfile,\n        profile: null,\n      };\n      dispatch(saveSocialMedia(socialMedia));\n    }\n  };\n\nexport const updateSocialMediaVariations =\n  () => async (dispatch: dispatch, getState: getState) => {\n    const socialMediaVariations =\n      await socialMediaService.retrieveSocialMediaVariations();\n    dispatch(upsertSocialMediaVariations(socialMediaVariations));\n  };\n\nexport const syncAndLinkSocialMedias =\n  () => async (dispatch: dispatch, getState: getState) => {\n    const socialMedias = selectAllSocialMedia(getState());\n    socialMedias.forEach((socialMedia) => {\n      if (socialMedia.profile) {\n        dispatch(saveAndLinkSocialMedia(socialMedia));\n      }\n    });\n  };\n\nexport const removeAllSocialMediasFromServer =\n  () => async (dispatch: dispatch, getState: getState) => {\n    const socialMedias = selectAllSocialMedia(getState());\n    for (let i = 0; i < socialMedias.length; i++) {\n      const socialMedia = socialMedias[i];\n      if (socialMedia.profile) {\n        await removeSocialFromServer(socialMedia);\n        const newSocialMedia: SocialMedia = {\n          ...socialMedia,\n          brightIdSocialAppData: {\n            ...socialMedia.brightIdSocialAppData,\n            synced: false,\n          },\n        };\n        dispatch(saveSocialMedia(newSocialMedia));\n      }\n    }\n  };\n\nexport const setSyncSocialMediaEnabledThunk =\n  (value: boolean) => async (dispatch: dispatch, getState: getState) => {\n    const prevState = selectSyncSocialMediaEnabled(getState());\n\n    dispatch(setSyncSocialMediaEnabled(value));\n    try {\n      if (value) {\n        await dispatch(syncAndLinkSocialMedias());\n      } else {\n        await dispatch(removeAllSocialMediasFromServer());\n      }\n    } catch (e) {\n      // rollback\n      dispatch(setSyncSocialMediaEnabled(prevState));\n    }\n  };\n"],"mappings":";;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAKA;;AAIA;;AACA;;AACA;;AAIA;;AACA;;AAEO,SAAeA,kBAAf,CAAkCC,KAAlC,EAAiDC,SAAjD;EAAA;EAAA;IAAA;MAAA;QAAA;UACDC,MADC,GACQ,KADR;UAECC,IAFD,GAEQ,IAAAC,wBAAA,EAAcC,cAAA,CAAMC,QAAN,EAAd,CAFR;UAGCC,OAHD,GAGW,IAAAC,WAAA,EAAK,IAAAC,aAAA,EAAO,IAAP,EAAaT,KAAb,CAAL,EAA0BG,IAA1B,CAHX;;UAAA,MAIDI,OAAO,IAAIA,OAAO,CAACG,aAJlB;YAAA;YAAA;UAAA;;UAKGC,eALH,GAKqB,IAAAC,yBAAA,EAAmBL,OAAnB,CALrB;;UAAA,MAODI,eAAe,IACfE,IAAI,CAACC,GAAL,KAAaH,eAAb,GAA+BI,qCAR9B;YAAA;YAAA;UAAA;;UAAA;UAAA;UAAA,kCAWgB,IAAAC,gBAAA,EAAUhB,KAAV,EAAiBC,SAAjB,EAA4B,IAA5B,CAXhB;;QAAA;UAWCC,MAXD;UAAA;UAAA;;QAAA;UAAA;UAAA;UAaCe,OAAO,CAACC,GAAR;;QAbD;UAAA,iCAiBEhB,MAjBF;;QAAA;QAAA;UAAA;MAAA;IAAA;EAAA;AAAA;;AAoBA,SAAeiB,eAAf,CACLC,KADK,EAELC,mBAFK,EAGLC,oBAHK;EAAA;;EAAA;EAAA;IAAA;MAAA;QAAA;UAKDC,MALC,GAKQ,KALR;UAMDtB,SANC,GAMW,0BAAAoB,mBAAmB,CAACG,qBAApB,2CAA2CvB,SAA3C,KAAwD,IANnE;UAOCwB,aAPD,GAOiB,IAAAC,wCAAA,EACpBL,mBAAmB,CAACM,OADA,EAEpBL,oBAAoB,CAACM,EAFD,CAPjB;;UAAA,KAWDR,KAXC;YAAA;YAAA;UAAA;;UAAA;UAAA;UAAA,kCAaKS,mCAAA,CAAmBC,iBAAnB,CAAqC;YACzCV,KAAK,EAALA,KADyC;YAEzCK,aAAa,EAAbA;UAFyC,CAArC,CAbL;;QAAA;UAiBDF,MAAM,GAAG,IAAT;UAjBC;UAAA;;QAAA;UAAA;UAAA;;UAAA,MAmBG,aAAEQ,OAAF,KAAcC,mDAnBjB;YAAA;YAAA;UAAA;;UAAA,kCAoBQb,eAAe,CAAC,IAAD,EAAOE,mBAAP,EAA4BC,oBAA5B,CApBvB;;QAAA;UAsBDL,OAAO,CAACC,GAAR;;QAtBC;UAAA;UAAA;;QAAA;UAAA;UAAA;UAAA,kCA0BkBW,mCAAA,CAAmBI,iBAAnB,CAAqC;YACtDR,aAAa,EAAbA,aADsD;YAEtDS,SAAS,EAAEZ,oBAAoB,CAACM,EAFsB;YAGtDO,OAAO,EAAEC,OAAO,GAAGC,sBAAA,CAAgBC,IAAnB,GAA0BD,sBAAA,CAAgBE;UAHJ,CAArC,CA1BlB;;QAAA;UA0BKC,IA1BL;UA+BDpB,KAAK,GAAGoB,IAAI,CAACpB,KAAb;UACAnB,SAAS,GAAGuC,IAAI,CAACvC,SAAjB;UACAsB,MAAM,GAAG,IAAT;UAjCC;UAAA;;QAAA;UAAA;UAAA;UAmCDN,OAAO,CAACC,GAAR;;QAnCC;UAAA,kCAsCE;YAAEE,KAAK,EAALA,KAAF;YAASnB,SAAS,EAATA,SAAT;YAAoBsB,MAAM,EAANA;UAApB,CAtCF;;QAAA;QAAA;UAAA;MAAA;IAAA;EAAA;AAAA;;AAyCA,IAAMkB,sBAAsB,GACjC,SADWA,sBACX,CAACpB,mBAAD;EAAA,OACA,iBAAOqB,QAAP,EAA2BpC,QAA3B;IAAA;;IAAA;MAAA;QAAA;UAAA;YACQqC,WADR,GACsB,IAAAC,uCAAA,EAClBtC,QAAQ,EADU,EAElBe,mBAAmB,CAACO,EAFF,CADtB;YAQEc,QAAQ,CAAC,IAAAG,iCAAA,EAAgBxB,mBAAhB,CAAD,CAAR;YACMyB,sBATR,GASiC,IAAAC,2CAAA,EAA6BzC,QAAQ,EAArC,CATjC;;YAAA,IAUOwC,sBAVP;cAAA;cAAA;YAAA;;YAAA,kCAWWzB,mBAXX;;UAAA;YAaQC,oBAbR,GAa+B,IAAA0B,yDAAA,EAC3B1C,QAAQ,EADmB,EAE3Be,mBAAmB,CAACO,EAFO,CAb/B;YAiBQJ,qBAjBR;cAkBID,MAAM,EAAE,KAlBZ;cAmBIrB,MAAM,EAAE,KAnBZ;cAoBID,SAAS,EAAE,IApBf;cAqBImB,KAAK,EAAE;YArBX,GAsBOC,mBAAmB,CAACG,qBAtB3B;YAwBQD,MAxBR,GAwB6CC,qBAxB7C,CAwBQD,MAxBR,EAwBgBH,KAxBhB,GAwB6CI,qBAxB7C,CAwBgBJ,KAxBhB,EAwBuBnB,SAxBvB,GAwB6CuB,qBAxB7C,CAwBuBvB,SAxBvB,EAwBkCC,MAxBlC,GAwB6CsB,qBAxB7C,CAwBkCtB,MAxBlC;;YAAA,MA0BM,CAACqB,MAAD,IAAW,CAAAoB,WAAW,QAAX,YAAAA,WAAW,CAAEhB,OAAb,MAAyBN,mBAAmB,CAACM,OA1B9D;cAAA;cAAA;YAAA;;YAAA;YAAA,kCA2BwBR,eAAe,CACjCC,KADiC,EAEjCC,mBAFiC,EAGjCC,oBAHiC,CA3BvC;;UAAA;YA2BU2B,KA3BV;YAgCI7B,KAAK,GAAG6B,KAAK,CAAC7B,KAAd;YACAnB,SAAS,GAAGgD,KAAK,CAAChD,SAAlB;YACAsB,MAAM,GAAG0B,KAAK,CAAC1B,MAAf;;UAlCJ;YAAA,MAqCMA,MAAM,IAAI,CAACrB,MArCjB;cAAA;cAAA;YAAA;;YAsCUF,KAtCV,GAsCkBsB,oBAAoB,CAAC4B,aAtCvC;;YAAA,KAuCQlD,KAvCR;cAAA;cAAA;YAAA;;YAAA;YAAA,kCAwCqBD,kBAAkB,CAACC,KAAD,EAAQC,SAAR,CAxCvC;;UAAA;YAwCMC,MAxCN;;UAAA;YA4CQiD,WA5CR,8BA6CO9B,mBA7CP;cA8CIG,qBAAqB,EAAE;gBAAED,MAAM,EAANA,MAAF;gBAAUH,KAAK,EAALA,KAAV;gBAAiBnB,SAAS,EAATA,SAAjB;gBAA4BC,MAAM,EAANA;cAA5B;YA9C3B;YAgDEwC,QAAQ,CAAC,IAAAG,iCAAA,EAAgBM,WAAhB,CAAD,CAAR;YAhDF,kCAiDSA,WAjDT;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CADA;AAAA,CADK;;;;AAsDA,IAAMC,sBAAsB,GAAG,kBAAOD,WAAP;EAAA;;EAAA;IAAA;MAAA;QAAA;UAAA,+BAChCA,WAAW,CAAC3B,qBADoB,aAChC,sBAAmCJ,KADH;YAAA;YAAA;UAAA;;UAAA;UAAA;UAAA,kCAG1BS,mCAAA,CAAmBwB,wBAAnB,CACJF,WAAW,CAAC3B,qBAAZ,CAAkCJ,KAD9B,CAH0B;;QAAA;UAAA;UAAA;;QAAA;UAAA;UAAA;;UAAA,MAS5B,aAAEW,OAAF,KAAcC,mDATc;YAAA;YAAA;UAAA;;UAAA;;QAAA;QAAA;UAAA;MAAA;IAAA;EAAA;AAAA,CAA/B;;;;AAgBA,IAAMsB,sBAAsB,GACjC,SADWA,sBACX,CAAC1B,EAAD;EAAA,OAAgB,kBAAOc,QAAP,EAA2BpC,QAA3B;IAAA;IAAA;MAAA;QAAA;UAAA;YACRqC,WADQ,GACM,IAAAC,uCAAA,EAAsBtC,QAAQ,EAA9B,EAAkCsB,EAAlC,CADN;;YAAA,KAEVe,WAFU;cAAA;cAAA;YAAA;;YAAA;YAAA,kCAGNS,sBAAsB,CAACT,WAAD,CAHhB;;UAAA;YAINQ,WAJM,8BAKPR,WALO;cAMVhB,OAAO,EAAE;YANC;YAQZe,QAAQ,CAAC,IAAAG,iCAAA,EAAgBM,WAAhB,CAAD,CAAR;;UARY;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAhB;AAAA,CADK;;;;AAaA,IAAMI,2BAA2B,GACtC,SADWA,2BACX;EAAA,OAAM,kBAAOb,QAAP,EAA2BpC,QAA3B;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA,kCAEIuB,mCAAA,CAAmB2B,6BAAnB,EAFJ;;UAAA;YACEC,qBADF;YAGJf,QAAQ,CAAC,IAAAgB,sDAAA,EAA4BD,qBAA5B,CAAD,CAAR;;UAHI;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAN;AAAA,CADK;;;;AAOA,IAAME,uBAAuB,GAClC,SADWA,uBACX;EAAA,OAAM,kBAAOjB,QAAP,EAA2BpC,QAA3B;IAAA;IAAA;MAAA;QAAA;UAAA;YACEsD,YADF,GACiB,IAAAC,sCAAA,EAAqBvD,QAAQ,EAA7B,CADjB;YAEJsD,YAAY,CAACE,OAAb,CAAqB,UAACX,WAAD,EAAiB;cACpC,IAAIA,WAAW,CAACxB,OAAhB,EAAyB;gBACvBe,QAAQ,CAACD,sBAAsB,CAACU,WAAD,CAAvB,CAAR;cACD;YACF,CAJD;;UAFI;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAN;AAAA,CADK;;;;AAUA,IAAMY,+BAA+B,GAC1C,SADWA,+BACX;EAAA,OAAM,kBAAOrB,QAAP,EAA2BpC,QAA3B;IAAA;IAAA;MAAA;QAAA;UAAA;YACEsD,YADF,GACiB,IAAAC,sCAAA,EAAqBvD,QAAQ,EAA7B,CADjB;YAEK0D,CAFL,GAES,CAFT;;UAAA;YAAA,MAEYA,CAAC,GAAGJ,YAAY,CAACK,MAF7B;cAAA;cAAA;YAAA;;YAGId,WAHJ,GAGkBS,YAAY,CAACI,CAAD,CAH9B;;YAAA,KAIEb,WAAW,CAACxB,OAJd;cAAA;cAAA;YAAA;;YAAA;YAAA,kCAKMyB,sBAAsB,CAACD,WAAD,CAL5B;;UAAA;YAMMe,cANN,8BAOKf,WAPL;cAQE3B,qBAAqB,6BAChB2B,WAAW,CAAC3B,qBADI;gBAEnBD,MAAM,EAAE;cAFW;YARvB;YAaAmB,QAAQ,CAAC,IAAAG,iCAAA,EAAgBqB,cAAhB,CAAD,CAAR;;UAbA;YAEqCF,CAAC,EAFtC;YAAA;YAAA;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAN;AAAA,CADK;;;;AAmBA,IAAMG,8BAA8B,GACzC,SADWA,8BACX,CAACC,KAAD;EAAA,OAAoB,kBAAO1B,QAAP,EAA2BpC,QAA3B;IAAA;IAAA;MAAA;QAAA;UAAA;YACZ+D,SADY,GACA,IAAAtB,2CAAA,EAA6BzC,QAAQ,EAArC,CADA;YAGlBoC,QAAQ,CAAC,IAAA4B,wCAAA,EAA0BF,KAA1B,CAAD,CAAR;YAHkB;;YAAA,KAKZA,KALY;cAAA;cAAA;YAAA;;YAAA;YAAA,kCAMR1B,QAAQ,CAACiB,uBAAuB,EAAxB,CANA;;UAAA;YAAA;YAAA;;UAAA;YAAA;YAAA,kCAQRjB,QAAQ,CAACqB,+BAA+B,EAAhC,CARA;;UAAA;YAAA;YAAA;;UAAA;YAAA;YAAA;YAYhBrB,QAAQ,CAAC,IAAA4B,wCAAA,EAA0BD,SAA1B,CAAD,CAAR;;UAZgB;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAApB;AAAA,CADK"},"metadata":{},"sourceType":"script"}