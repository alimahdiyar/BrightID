{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { find, propEq } from 'ramda';\nimport { SOCIAL_API_AUTHENTICATION_ERROR } from \"../../api/socialMediaService\";\nimport { getSignedTimestamp, linkAppId } from \"../Apps/model\";\nimport store from \"../../store\";\nimport { selectAllApps } from \"../../reducer/appsSlice\";\nimport { saveSocialMedia, selectAllSocialMedia, selectSocialMediaById } from \"../../reducer/socialMediaSlice\";\nimport { selectSocialMediaVariationById, upsertSocialMediaVariations } from \"../../reducer/socialMediaVariationSlice\";\nimport { generateSocialProfileHashes } from \"../../utils/socialUtils\";\nimport { SOCIAL_MEDIA_SIG_WAIT_TIME } from \"../../utils/constants\";\nimport { selectSyncSocialMediaEnabled, setSyncSocialMediaEnabled } from \"../../reducer/settingsSlice\";\nimport { BrightIdNetwork } from \"../Apps/types.d\";\nimport socialMediaService from \"../../utils/socialMediaServiceProvider\";\nexport function linkSocialMediaApp(appId, appUserId) {\n  var linked, apps, appInfo, signedTimestamp;\n  return _regeneratorRuntime.async(function linkSocialMediaApp$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          linked = false;\n          apps = selectAllApps(store.getState());\n          appInfo = find(propEq('id', appId))(apps);\n\n          if (!(appInfo && appInfo.usingBlindSig)) {\n            _context.next = 15;\n            break;\n          }\n\n          signedTimestamp = getSignedTimestamp(appInfo);\n\n          if (!(signedTimestamp && Date.now() - signedTimestamp > SOCIAL_MEDIA_SIG_WAIT_TIME)) {\n            _context.next = 15;\n            break;\n          }\n\n          _context.prev = 6;\n          _context.next = 9;\n          return _regeneratorRuntime.awrap(linkAppId(appId, appUserId, true));\n\n        case 9:\n          linked = _context.sent;\n          _context.next = 15;\n          break;\n\n        case 12:\n          _context.prev = 12;\n          _context.t0 = _context[\"catch\"](6);\n          console.log(_context.t0);\n\n        case 15:\n          return _context.abrupt(\"return\", linked);\n\n        case 16:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, [[6, 12]], Promise);\n}\nexport function syncSocialMedia(token, incomingSocialMedia, socialMediaVariation) {\n  var _incomingSocialMedia$;\n\n  var synced, appUserId, profileHashes, data;\n  return _regeneratorRuntime.async(function syncSocialMedia$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          synced = false;\n          appUserId = ((_incomingSocialMedia$ = incomingSocialMedia.brightIdSocialAppData) == null ? void 0 : _incomingSocialMedia$.appUserId) || null;\n          profileHashes = generateSocialProfileHashes(incomingSocialMedia.profile, socialMediaVariation.id);\n\n          if (!token) {\n            _context2.next = 17;\n            break;\n          }\n\n          _context2.prev = 4;\n          _context2.next = 7;\n          return _regeneratorRuntime.awrap(socialMediaService.updateSocialMedia({\n            token: token,\n            profileHashes: profileHashes\n          }));\n\n        case 7:\n          synced = true;\n          _context2.next = 15;\n          break;\n\n        case 10:\n          _context2.prev = 10;\n          _context2.t0 = _context2[\"catch\"](4);\n\n          if (!(_context2.t0.message === SOCIAL_API_AUTHENTICATION_ERROR)) {\n            _context2.next = 14;\n            break;\n          }\n\n          return _context2.abrupt(\"return\", syncSocialMedia(null, incomingSocialMedia, socialMediaVariation));\n\n        case 14:\n          console.log(_context2.t0);\n\n        case 15:\n          _context2.next = 29;\n          break;\n\n        case 17:\n          _context2.prev = 17;\n          _context2.next = 20;\n          return _regeneratorRuntime.awrap(socialMediaService.createSocialMedia({\n            profileHashes: profileHashes,\n            variation: socialMediaVariation.id,\n            network: __DEV__ ? BrightIdNetwork.TEST : BrightIdNetwork.NODE\n          }));\n\n        case 20:\n          data = _context2.sent;\n          token = data.token;\n          appUserId = data.appUserId;\n          synced = true;\n          _context2.next = 29;\n          break;\n\n        case 26:\n          _context2.prev = 26;\n          _context2.t1 = _context2[\"catch\"](17);\n          console.log(_context2.t1);\n\n        case 29:\n          return _context2.abrupt(\"return\", {\n            token: token,\n            appUserId: appUserId,\n            synced: synced\n          });\n\n        case 30:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, [[4, 10], [17, 26]], Promise);\n}\nexport var saveAndLinkSocialMedia = function saveAndLinkSocialMedia(incomingSocialMedia) {\n  return function _callee(dispatch, getState) {\n    var prevProfile, syncSocialMediaEnabled, socialMediaVariation, brightIdSocialAppData, synced, token, appUserId, linked, __ret, appId, socialMedia;\n\n    return _regeneratorRuntime.async(function _callee$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            prevProfile = selectSocialMediaById(getState(), incomingSocialMedia.id);\n            dispatch(saveSocialMedia(incomingSocialMedia));\n            syncSocialMediaEnabled = selectSyncSocialMediaEnabled(getState());\n\n            if (syncSocialMediaEnabled) {\n              _context3.next = 5;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", incomingSocialMedia);\n\n          case 5:\n            socialMediaVariation = selectSocialMediaVariationById(getState(), incomingSocialMedia.id);\n            brightIdSocialAppData = _objectSpread({\n              synced: false,\n              linked: false,\n              appUserId: null,\n              token: null\n            }, incomingSocialMedia.brightIdSocialAppData);\n            synced = brightIdSocialAppData.synced, token = brightIdSocialAppData.token, appUserId = brightIdSocialAppData.appUserId, linked = brightIdSocialAppData.linked;\n\n            if (!(!synced || (prevProfile == null ? void 0 : prevProfile.profile) !== incomingSocialMedia.profile)) {\n              _context3.next = 15;\n              break;\n            }\n\n            _context3.next = 11;\n            return _regeneratorRuntime.awrap(syncSocialMedia(token, incomingSocialMedia, socialMediaVariation));\n\n          case 11:\n            __ret = _context3.sent;\n            token = __ret.token;\n            appUserId = __ret.appUserId;\n            synced = __ret.synced;\n\n          case 15:\n            if (!(synced && !linked)) {\n              _context3.next = 21;\n              break;\n            }\n\n            appId = socialMediaVariation.brightIdAppId;\n\n            if (!appId) {\n              _context3.next = 21;\n              break;\n            }\n\n            _context3.next = 20;\n            return _regeneratorRuntime.awrap(linkSocialMediaApp(appId, appUserId));\n\n          case 20:\n            linked = _context3.sent;\n\n          case 21:\n            socialMedia = _objectSpread(_objectSpread({}, incomingSocialMedia), {}, {\n              brightIdSocialAppData: {\n                synced: synced,\n                token: token,\n                appUserId: appUserId,\n                linked: linked\n              }\n            });\n            dispatch(saveSocialMedia(socialMedia));\n            return _context3.abrupt(\"return\", socialMedia);\n\n          case 24:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\nexport var removeSocialFromServer = function _callee2(socialMedia) {\n  var _socialMedia$brightId;\n\n  return _regeneratorRuntime.async(function _callee2$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          if (!((_socialMedia$brightId = socialMedia.brightIdSocialAppData) != null && _socialMedia$brightId.token)) {\n            _context4.next = 10;\n            break;\n          }\n\n          _context4.prev = 1;\n          _context4.next = 4;\n          return _regeneratorRuntime.awrap(socialMediaService.deleteSocialMediaProfile(socialMedia.brightIdSocialAppData.token));\n\n        case 4:\n          _context4.next = 10;\n          break;\n\n        case 6:\n          _context4.prev = 6;\n          _context4.t0 = _context4[\"catch\"](1);\n\n          if (!(_context4.t0.message !== SOCIAL_API_AUTHENTICATION_ERROR)) {\n            _context4.next = 10;\n            break;\n          }\n\n          throw _context4.t0;\n\n        case 10:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, null, null, [[1, 6]], Promise);\n};\nexport var removeSocialMediaThunk = function removeSocialMediaThunk(id) {\n  return function _callee3(dispatch, getState) {\n    var prevProfile, socialMedia;\n    return _regeneratorRuntime.async(function _callee3$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            prevProfile = selectSocialMediaById(getState(), id);\n\n            if (!prevProfile) {\n              _context5.next = 6;\n              break;\n            }\n\n            _context5.next = 4;\n            return _regeneratorRuntime.awrap(removeSocialFromServer(prevProfile));\n\n          case 4:\n            socialMedia = _objectSpread(_objectSpread({}, prevProfile), {}, {\n              profile: null\n            });\n            dispatch(saveSocialMedia(socialMedia));\n\n          case 6:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\nexport var updateSocialMediaVariations = function updateSocialMediaVariations() {\n  return function _callee4(dispatch, getState) {\n    var socialMediaVariations;\n    return _regeneratorRuntime.async(function _callee4$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            _context6.next = 2;\n            return _regeneratorRuntime.awrap(socialMediaService.retrieveSocialMediaVariations());\n\n          case 2:\n            socialMediaVariations = _context6.sent;\n            dispatch(upsertSocialMediaVariations(socialMediaVariations));\n\n          case 4:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\nexport var syncAndLinkSocialMedias = function syncAndLinkSocialMedias() {\n  return function _callee5(dispatch, getState) {\n    var socialMedias;\n    return _regeneratorRuntime.async(function _callee5$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            socialMedias = selectAllSocialMedia(getState());\n            socialMedias.forEach(function (socialMedia) {\n              if (socialMedia.profile) {\n                dispatch(saveAndLinkSocialMedia(socialMedia));\n              }\n            });\n\n          case 2:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\nexport var removeAllSocialMediasFromServer = function removeAllSocialMediasFromServer() {\n  return function _callee6(dispatch, getState) {\n    var socialMedias, i, socialMedia, newSocialMedia;\n    return _regeneratorRuntime.async(function _callee6$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            socialMedias = selectAllSocialMedia(getState());\n            i = 0;\n\n          case 2:\n            if (!(i < socialMedias.length)) {\n              _context8.next = 12;\n              break;\n            }\n\n            socialMedia = socialMedias[i];\n\n            if (!socialMedia.profile) {\n              _context8.next = 9;\n              break;\n            }\n\n            _context8.next = 7;\n            return _regeneratorRuntime.awrap(removeSocialFromServer(socialMedia));\n\n          case 7:\n            newSocialMedia = _objectSpread(_objectSpread({}, socialMedia), {}, {\n              brightIdSocialAppData: _objectSpread(_objectSpread({}, socialMedia.brightIdSocialAppData), {}, {\n                synced: false\n              })\n            });\n            dispatch(saveSocialMedia(newSocialMedia));\n\n          case 9:\n            i++;\n            _context8.next = 2;\n            break;\n\n          case 12:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\nexport var setSyncSocialMediaEnabledThunk = function setSyncSocialMediaEnabledThunk(value) {\n  return function _callee7(dispatch, getState) {\n    var prevState;\n    return _regeneratorRuntime.async(function _callee7$(_context9) {\n      while (1) {\n        switch (_context9.prev = _context9.next) {\n          case 0:\n            prevState = selectSyncSocialMediaEnabled(getState());\n            dispatch(setSyncSocialMediaEnabled(value));\n            _context9.prev = 2;\n\n            if (!value) {\n              _context9.next = 8;\n              break;\n            }\n\n            _context9.next = 6;\n            return _regeneratorRuntime.awrap(dispatch(syncAndLinkSocialMedias()));\n\n          case 6:\n            _context9.next = 10;\n            break;\n\n          case 8:\n            _context9.next = 10;\n            return _regeneratorRuntime.awrap(dispatch(removeAllSocialMediasFromServer()));\n\n          case 10:\n            _context9.next = 15;\n            break;\n\n          case 12:\n            _context9.prev = 12;\n            _context9.t0 = _context9[\"catch\"](2);\n            dispatch(setSyncSocialMediaEnabled(prevState));\n\n          case 15:\n          case \"end\":\n            return _context9.stop();\n        }\n      }\n    }, null, null, [[2, 12]], Promise);\n  };\n};","map":{"version":3,"names":["find","propEq","SOCIAL_API_AUTHENTICATION_ERROR","getSignedTimestamp","linkAppId","store","selectAllApps","saveSocialMedia","selectAllSocialMedia","selectSocialMediaById","selectSocialMediaVariationById","upsertSocialMediaVariations","generateSocialProfileHashes","SOCIAL_MEDIA_SIG_WAIT_TIME","selectSyncSocialMediaEnabled","setSyncSocialMediaEnabled","BrightIdNetwork","socialMediaService","linkSocialMediaApp","appId","appUserId","linked","apps","getState","appInfo","usingBlindSig","signedTimestamp","Date","now","console","log","syncSocialMedia","token","incomingSocialMedia","socialMediaVariation","synced","brightIdSocialAppData","profileHashes","profile","id","updateSocialMedia","message","createSocialMedia","variation","network","__DEV__","TEST","NODE","data","saveAndLinkSocialMedia","dispatch","prevProfile","syncSocialMediaEnabled","__ret","brightIdAppId","socialMedia","removeSocialFromServer","deleteSocialMediaProfile","removeSocialMediaThunk","updateSocialMediaVariations","retrieveSocialMediaVariations","socialMediaVariations","syncAndLinkSocialMedias","socialMedias","forEach","removeAllSocialMediasFromServer","i","length","newSocialMedia","setSyncSocialMediaEnabledThunk","value","prevState"],"sources":["/home/ali/Desktop/brightid/BrightID/BrightID/src/components/EditProfile/socialMediaThunks.ts"],"sourcesContent":["import { find, propEq } from 'ramda';\nimport { SOCIAL_API_AUTHENTICATION_ERROR } from '@/api/socialMediaService';\nimport { getSignedTimestamp, linkAppId } from '@/components/Apps/model';\nimport store from '@/store';\nimport { selectAllApps } from '@/reducer/appsSlice';\nimport {\n  saveSocialMedia,\n  selectAllSocialMedia,\n  selectSocialMediaById,\n} from '@/reducer/socialMediaSlice';\nimport {\n  selectSocialMediaVariationById,\n  upsertSocialMediaVariations,\n} from '@/reducer/socialMediaVariationSlice';\nimport { generateSocialProfileHashes } from '@/utils/socialUtils';\nimport { SOCIAL_MEDIA_SIG_WAIT_TIME } from '@/utils/constants';\nimport {\n  selectSyncSocialMediaEnabled,\n  setSyncSocialMediaEnabled,\n} from '@/reducer/settingsSlice';\nimport { BrightIdNetwork } from '@/components/Apps/types.d';\nimport socialMediaService from '@/utils/socialMediaServiceProvider';\n\nexport async function linkSocialMediaApp(appId: string, appUserId: string) {\n  let linked = false;\n  const apps = selectAllApps(store.getState());\n  const appInfo = find(propEq('id', appId))(apps) as AppInfo;\n  if (appInfo && appInfo.usingBlindSig) {\n    const signedTimestamp = getSignedTimestamp(appInfo);\n    if (\n      signedTimestamp &&\n      Date.now() - signedTimestamp > SOCIAL_MEDIA_SIG_WAIT_TIME\n    ) {\n      try {\n        linked = await linkAppId(appId, appUserId, true);\n      } catch (e) {\n        console.log(e);\n      }\n    }\n  }\n  return linked;\n}\n\nexport async function syncSocialMedia(\n  token: string,\n  incomingSocialMedia: SocialMedia,\n  socialMediaVariation: SocialMediaVariation,\n) {\n  let synced = false;\n  let appUserId = incomingSocialMedia.brightIdSocialAppData?.appUserId || null;\n  const profileHashes = generateSocialProfileHashes(\n    incomingSocialMedia.profile,\n    socialMediaVariation.id,\n  );\n  if (token) {\n    try {\n      await socialMediaService.updateSocialMedia({\n        token,\n        profileHashes,\n      });\n      synced = true;\n    } catch (e) {\n      if (e.message === SOCIAL_API_AUTHENTICATION_ERROR) {\n        return syncSocialMedia(null, incomingSocialMedia, socialMediaVariation);\n      }\n      console.log(e);\n    }\n  } else {\n    try {\n      const data = await socialMediaService.createSocialMedia({\n        profileHashes,\n        variation: socialMediaVariation.id,\n        network: __DEV__ ? BrightIdNetwork.TEST : BrightIdNetwork.NODE,\n      });\n      token = data.token;\n      appUserId = data.appUserId;\n      synced = true;\n    } catch (e) {\n      console.log(e);\n    }\n  }\n  return { token, appUserId, synced };\n}\n\nexport const saveAndLinkSocialMedia =\n  (incomingSocialMedia: SocialMedia) =>\n  async (dispatch: dispatch, getState: getState) => {\n    const prevProfile = selectSocialMediaById(\n      getState(),\n      incomingSocialMedia.id,\n    );\n\n    // First, update locally, so the user doesn't need to wait for\n    // the server to complete the request to see his new profile in the UI.\n    dispatch(saveSocialMedia(incomingSocialMedia));\n    const syncSocialMediaEnabled = selectSyncSocialMediaEnabled(getState());\n    if (!syncSocialMediaEnabled) {\n      return incomingSocialMedia;\n    }\n    const socialMediaVariation = selectSocialMediaVariationById(\n      getState(),\n      incomingSocialMedia.id,\n    );\n    const brightIdSocialAppData: BrightIdSocialAppData = {\n      synced: false,\n      linked: false,\n      appUserId: null,\n      token: null,\n      ...incomingSocialMedia.brightIdSocialAppData,\n    };\n    let { synced, token, appUserId, linked } = brightIdSocialAppData;\n\n    if (!synced || prevProfile?.profile !== incomingSocialMedia.profile) {\n      const __ret = await syncSocialMedia(\n        token,\n        incomingSocialMedia,\n        socialMediaVariation,\n      );\n      token = __ret.token;\n      appUserId = __ret.appUserId;\n      synced = __ret.synced;\n    }\n\n    if (synced && !linked) {\n      const appId = socialMediaVariation.brightIdAppId;\n      if (appId) {\n        linked = await linkSocialMediaApp(appId, appUserId);\n      }\n    }\n\n    const socialMedia: SocialMedia = {\n      ...incomingSocialMedia,\n      brightIdSocialAppData: { synced, token, appUserId, linked },\n    };\n    dispatch(saveSocialMedia(socialMedia));\n    return socialMedia;\n  };\n\nexport const removeSocialFromServer = async (socialMedia: SocialMedia) => {\n  if (socialMedia.brightIdSocialAppData?.token) {\n    try {\n      await socialMediaService.deleteSocialMediaProfile(\n        socialMedia.brightIdSocialAppData.token,\n      );\n    } catch (e) {\n      // if the token by some reason doesn't exist on the server, so\n      // there is nothing to delete, so ignore the error.\n      if (e.message !== SOCIAL_API_AUTHENTICATION_ERROR) {\n        throw e;\n      }\n    }\n  }\n};\n\nexport const removeSocialMediaThunk =\n  (id: string) => async (dispatch: dispatch, getState: getState) => {\n    const prevProfile = selectSocialMediaById(getState(), id);\n    if (prevProfile) {\n      await removeSocialFromServer(prevProfile);\n      const socialMedia: SocialMedia = {\n        ...prevProfile,\n        profile: null,\n      };\n      dispatch(saveSocialMedia(socialMedia));\n    }\n  };\n\nexport const updateSocialMediaVariations =\n  () => async (dispatch: dispatch, getState: getState) => {\n    const socialMediaVariations =\n      await socialMediaService.retrieveSocialMediaVariations();\n    dispatch(upsertSocialMediaVariations(socialMediaVariations));\n  };\n\nexport const syncAndLinkSocialMedias =\n  () => async (dispatch: dispatch, getState: getState) => {\n    const socialMedias = selectAllSocialMedia(getState());\n    socialMedias.forEach((socialMedia) => {\n      if (socialMedia.profile) {\n        dispatch(saveAndLinkSocialMedia(socialMedia));\n      }\n    });\n  };\n\nexport const removeAllSocialMediasFromServer =\n  () => async (dispatch: dispatch, getState: getState) => {\n    const socialMedias = selectAllSocialMedia(getState());\n    for (let i = 0; i < socialMedias.length; i++) {\n      const socialMedia = socialMedias[i];\n      if (socialMedia.profile) {\n        await removeSocialFromServer(socialMedia);\n        const newSocialMedia: SocialMedia = {\n          ...socialMedia,\n          brightIdSocialAppData: {\n            ...socialMedia.brightIdSocialAppData,\n            synced: false,\n          },\n        };\n        dispatch(saveSocialMedia(newSocialMedia));\n      }\n    }\n  };\n\nexport const setSyncSocialMediaEnabledThunk =\n  (value: boolean) => async (dispatch: dispatch, getState: getState) => {\n    const prevState = selectSyncSocialMediaEnabled(getState());\n\n    dispatch(setSyncSocialMediaEnabled(value));\n    try {\n      if (value) {\n        await dispatch(syncAndLinkSocialMedias());\n      } else {\n        await dispatch(removeAllSocialMediasFromServer());\n      }\n    } catch (e) {\n      // rollback\n      dispatch(setSyncSocialMediaEnabled(prevState));\n    }\n  };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}