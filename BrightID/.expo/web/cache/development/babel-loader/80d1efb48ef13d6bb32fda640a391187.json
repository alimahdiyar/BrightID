{"ast":null,"code":"import { createSlice, createEntityAdapter, createSelector } from '@reduxjs/toolkit';\nimport { original } from 'immer';\nvar socialMediaAdapter = createEntityAdapter({\n  sortComparer: function sortComparer(a, b) {\n    return a.order - b.order;\n  }\n});\nvar socialMediaSlice = createSlice({\n  name: 'socialMedia',\n  initialState: socialMediaAdapter.getInitialState(),\n  reducers: {\n    saveSocialMedia: function saveSocialMedia(state, action) {\n      var _action$payload = action.payload,\n          incomingId = _action$payload.id,\n          incomingOrder = _action$payload.order,\n          incomingProfile = _action$payload.profile,\n          incomingBrightIdSocialAppData = _action$payload.brightIdSocialAppData;\n\n      var _original = original(state),\n          entities = _original.entities,\n          ids = _original.ids;\n\n      var prevEntity = entities[incomingId];\n\n      if (!prevEntity) {\n        socialMediaAdapter.addOne(state, action);\n\n        if (incomingOrder < ids.length) {\n          var entityToRemove = Object.values(entities).find(function (entity) {\n            return entity.order === incomingOrder;\n          });\n          socialMediaAdapter.removeOne(state, entityToRemove.id);\n        }\n      }\n\n      if (prevEntity && prevEntity.order === incomingOrder) {\n        socialMediaAdapter.updateOne(state, {\n          id: incomingId,\n          changes: {\n            profile: incomingProfile,\n            brightIdSocialAppData: incomingBrightIdSocialAppData\n          }\n        });\n      }\n\n      if (prevEntity && prevEntity.order !== incomingOrder) {\n        var shouldIncrement = prevEntity.order > incomingOrder;\n        var shouldDecrement = !shouldIncrement;\n        var updateList = Object.values(entities).map(function (entity) {\n          var order = entity.order,\n              profile = entity.profile,\n              brightIdSocialAppData = entity.brightIdSocialAppData;\n\n          if (entity.id === incomingId) {\n            order = incomingOrder;\n            profile = incomingProfile;\n            brightIdSocialAppData = incomingBrightIdSocialAppData;\n          } else if (shouldIncrement && order >= incomingOrder && order <= prevEntity.order) {\n            order += 1;\n          } else if (shouldDecrement && order <= incomingOrder && order >= prevEntity.order) {\n            order -= 1;\n          }\n\n          return {\n            id: entity.id,\n            changes: {\n              order: order,\n              profile: profile,\n              brightIdSocialAppData: brightIdSocialAppData\n            }\n          };\n        });\n        socialMediaAdapter.updateMany(state, updateList);\n      }\n    },\n    setProfileDisplayWidth: function setProfileDisplayWidth(state, action) {\n      socialMediaAdapter.updateOne(state, {\n        id: action.payload.id,\n        changes: {\n          profileDisplayWidth: action.payload.width\n        }\n      });\n    }\n  }\n});\nvar _socialMediaSlice$act = socialMediaSlice.actions,\n    saveSocialMedia = _socialMediaSlice$act.saveSocialMedia,\n    setProfileDisplayWidth = _socialMediaSlice$act.setProfileDisplayWidth;\nexport { saveSocialMedia, setProfileDisplayWidth };\n\nvar _socialMediaAdapter$g = socialMediaAdapter.getSelectors(function (state) {\n  return state.socialMedia;\n}),\n    selectSocialMediaById = _socialMediaAdapter$g.selectById,\n    selectAllSocialMedia = _socialMediaAdapter$g.selectAll;\n\nexport { selectSocialMediaById, selectAllSocialMedia };\nexport var selectExistingSocialMedia = createSelector(selectAllSocialMedia, function (socialMedias) {\n  return socialMedias.filter(function (socialMedia) {\n    return socialMedia.profile;\n  });\n});\nexport var selectExistingSocialMediaIds = createSelector(selectExistingSocialMedia, function (socialMedias) {\n  return socialMedias.map(function (socialMedia) {\n    return socialMedia.id;\n  });\n});\nexport var selectAllSocialMediaToShare = createSelector(selectExistingSocialMedia, function (socialMedias) {\n  return socialMedias.map(function (socialMedia) {\n    return {\n      id: socialMedia.id,\n      company: socialMedia.company,\n      order: socialMedia.order,\n      profile: socialMedia.profile,\n      profileDisplayWidth: socialMedia.profileDisplayWidth\n    };\n  });\n});\nexport default socialMediaSlice.reducer;","map":{"version":3,"names":["createSlice","createEntityAdapter","createSelector","original","socialMediaAdapter","sortComparer","a","b","order","socialMediaSlice","name","initialState","getInitialState","reducers","saveSocialMedia","state","action","payload","incomingId","id","incomingOrder","incomingProfile","profile","incomingBrightIdSocialAppData","brightIdSocialAppData","entities","ids","prevEntity","addOne","length","entityToRemove","Object","values","find","entity","removeOne","updateOne","changes","shouldIncrement","shouldDecrement","updateList","map","updateMany","setProfileDisplayWidth","profileDisplayWidth","width","actions","getSelectors","socialMedia","selectSocialMediaById","selectById","selectAllSocialMedia","selectAll","selectExistingSocialMedia","socialMedias","filter","selectExistingSocialMediaIds","selectAllSocialMediaToShare","company","reducer"],"sources":["/home/ali/Desktop/brightid/BrightID/BrightID/src/reducer/socialMediaSlice.ts"],"sourcesContent":["import {\n  createSlice,\n  createEntityAdapter,\n  PayloadAction,\n  createSelector,\n} from '@reduxjs/toolkit';\n\nimport { original, Draft } from 'immer';\n\nconst socialMediaAdapter = createEntityAdapter<SocialMedia>({\n  sortComparer: (a, b) => a.order - b.order,\n});\n\nconst socialMediaSlice = createSlice({\n  name: 'socialMedia',\n  initialState: socialMediaAdapter.getInitialState(),\n  reducers: {\n    saveSocialMedia: (\n      state: Draft<SocialMediaState>,\n      action: PayloadAction<SocialMedia>,\n    ) => {\n      // incoming payload values\n      const {\n        id: incomingId,\n        order: incomingOrder,\n        profile: incomingProfile,\n        brightIdSocialAppData: incomingBrightIdSocialAppData,\n      } = action.payload;\n\n      // access previous values from the reducer\n      const { entities, ids } = original(state);\n\n      const prevEntity = entities[incomingId];\n\n      // if social media does not already exist, add it to the list,\n      if (!prevEntity) {\n        socialMediaAdapter.addOne(state, action);\n        // if order already exists in list, then the user wants to replace the social media\n        if (incomingOrder < ids.length) {\n          const entityToRemove = Object.values(entities).find(\n            (entity) => entity.order === incomingOrder,\n          );\n\n          socialMediaAdapter.removeOne(state, entityToRemove.id);\n        }\n      }\n\n      // the user is only updating their social media profile\n      if (prevEntity && prevEntity.order === incomingOrder) {\n        socialMediaAdapter.updateOne(state, {\n          id: incomingId,\n          changes: {\n            profile: incomingProfile,\n            brightIdSocialAppData: incomingBrightIdSocialAppData,\n          },\n        });\n      }\n\n      // this indicates the user wants to re-order the list\n      if (prevEntity && prevEntity.order !== incomingOrder) {\n        // only update the order for\n        // 1. incoming id\n        // 2. Entities between previous order and incoming order\n\n        const shouldIncrement = prevEntity.order > incomingOrder;\n        const shouldDecrement = !shouldIncrement;\n\n        const updateList = Object.values(entities).map((entity) => {\n          let { order, profile, brightIdSocialAppData } = entity;\n          if (entity.id === incomingId) {\n            order = incomingOrder;\n            profile = incomingProfile;\n            brightIdSocialAppData = incomingBrightIdSocialAppData;\n          } else if (\n            shouldIncrement &&\n            order >= incomingOrder &&\n            order <= prevEntity.order\n          ) {\n            order += 1;\n          } else if (\n            shouldDecrement &&\n            order <= incomingOrder &&\n            order >= prevEntity.order\n          ) {\n            order -= 1;\n          }\n\n          return {\n            id: entity.id,\n            changes: { order, profile, brightIdSocialAppData },\n          };\n        });\n\n        socialMediaAdapter.updateMany(state, updateList);\n      }\n    },\n    setProfileDisplayWidth: (\n      state: Draft<SocialMediaState>,\n      action: PayloadAction<{ id: string; width: number | string }>,\n    ) => {\n      socialMediaAdapter.updateOne(state, {\n        id: action.payload.id,\n        changes: {\n          profileDisplayWidth: action.payload.width,\n        },\n      });\n    },\n  },\n});\n\nexport const { saveSocialMedia, setProfileDisplayWidth } =\n  socialMediaSlice.actions;\n\nexport const {\n  selectById: selectSocialMediaById,\n  selectAll: selectAllSocialMedia,\n} = socialMediaAdapter.getSelectors((state: State) => state.socialMedia);\n\nexport const selectExistingSocialMedia = createSelector(\n  selectAllSocialMedia,\n  (socialMedias) => socialMedias.filter((socialMedia) => socialMedia.profile),\n);\n\nexport const selectExistingSocialMediaIds = createSelector(\n  selectExistingSocialMedia,\n  (socialMedias) => socialMedias.map((socialMedia) => socialMedia.id),\n);\n\nexport const selectAllSocialMediaToShare = createSelector(\n  selectExistingSocialMedia,\n  (socialMedias) =>\n    socialMedias.map((socialMedia) => ({\n      id: socialMedia.id,\n      company: socialMedia.company,\n      order: socialMedia.order,\n      profile: socialMedia.profile,\n      profileDisplayWidth: socialMedia.profileDisplayWidth,\n    })) as SocialMediaShared[],\n);\nexport default socialMediaSlice.reducer;\n"],"mappings":"AAAA,SACEA,WADF,EAEEC,mBAFF,EAIEC,cAJF,QAKO,kBALP;AAOA,SAASC,QAAT,QAAgC,OAAhC;AAEA,IAAMC,kBAAkB,GAAGH,mBAAmB,CAAc;EAC1DI,YAAY,EAAE,sBAACC,CAAD,EAAIC,CAAJ;IAAA,OAAUD,CAAC,CAACE,KAAF,GAAUD,CAAC,CAACC,KAAtB;EAAA;AAD4C,CAAd,CAA9C;AAIA,IAAMC,gBAAgB,GAAGT,WAAW,CAAC;EACnCU,IAAI,EAAE,aAD6B;EAEnCC,YAAY,EAAEP,kBAAkB,CAACQ,eAAnB,EAFqB;EAGnCC,QAAQ,EAAE;IACRC,eAAe,EAAE,yBACfC,KADe,EAEfC,MAFe,EAGZ;MAEH,sBAKIA,MAAM,CAACC,OALX;MAAA,IACMC,UADN,mBACEC,EADF;MAAA,IAESC,aAFT,mBAEEZ,KAFF;MAAA,IAGWa,eAHX,mBAGEC,OAHF;MAAA,IAIyBC,6BAJzB,mBAIEC,qBAJF;;MAQA,gBAA0BrB,QAAQ,CAACY,KAAD,CAAlC;MAAA,IAAQU,QAAR,aAAQA,QAAR;MAAA,IAAkBC,GAAlB,aAAkBA,GAAlB;;MAEA,IAAMC,UAAU,GAAGF,QAAQ,CAACP,UAAD,CAA3B;;MAGA,IAAI,CAACS,UAAL,EAAiB;QACfvB,kBAAkB,CAACwB,MAAnB,CAA0Bb,KAA1B,EAAiCC,MAAjC;;QAEA,IAAII,aAAa,GAAGM,GAAG,CAACG,MAAxB,EAAgC;UAC9B,IAAMC,cAAc,GAAGC,MAAM,CAACC,MAAP,CAAcP,QAAd,EAAwBQ,IAAxB,CACrB,UAACC,MAAD;YAAA,OAAYA,MAAM,CAAC1B,KAAP,KAAiBY,aAA7B;UAAA,CADqB,CAAvB;UAIAhB,kBAAkB,CAAC+B,SAAnB,CAA6BpB,KAA7B,EAAoCe,cAAc,CAACX,EAAnD;QACD;MACF;;MAGD,IAAIQ,UAAU,IAAIA,UAAU,CAACnB,KAAX,KAAqBY,aAAvC,EAAsD;QACpDhB,kBAAkB,CAACgC,SAAnB,CAA6BrB,KAA7B,EAAoC;UAClCI,EAAE,EAAED,UAD8B;UAElCmB,OAAO,EAAE;YACPf,OAAO,EAAED,eADF;YAEPG,qBAAqB,EAAED;UAFhB;QAFyB,CAApC;MAOD;;MAGD,IAAII,UAAU,IAAIA,UAAU,CAACnB,KAAX,KAAqBY,aAAvC,EAAsD;QAKpD,IAAMkB,eAAe,GAAGX,UAAU,CAACnB,KAAX,GAAmBY,aAA3C;QACA,IAAMmB,eAAe,GAAG,CAACD,eAAzB;QAEA,IAAME,UAAU,GAAGT,MAAM,CAACC,MAAP,CAAcP,QAAd,EAAwBgB,GAAxB,CAA4B,UAACP,MAAD,EAAY;UACzD,IAAM1B,KAAN,GAAgD0B,MAAhD,CAAM1B,KAAN;UAAA,IAAac,OAAb,GAAgDY,MAAhD,CAAaZ,OAAb;UAAA,IAAsBE,qBAAtB,GAAgDU,MAAhD,CAAsBV,qBAAtB;;UACA,IAAIU,MAAM,CAACf,EAAP,KAAcD,UAAlB,EAA8B;YAC5BV,KAAK,GAAGY,aAAR;YACAE,OAAO,GAAGD,eAAV;YACAG,qBAAqB,GAAGD,6BAAxB;UACD,CAJD,MAIO,IACLe,eAAe,IACf9B,KAAK,IAAIY,aADT,IAEAZ,KAAK,IAAImB,UAAU,CAACnB,KAHf,EAIL;YACAA,KAAK,IAAI,CAAT;UACD,CANM,MAMA,IACL+B,eAAe,IACf/B,KAAK,IAAIY,aADT,IAEAZ,KAAK,IAAImB,UAAU,CAACnB,KAHf,EAIL;YACAA,KAAK,IAAI,CAAT;UACD;;UAED,OAAO;YACLW,EAAE,EAAEe,MAAM,CAACf,EADN;YAELkB,OAAO,EAAE;cAAE7B,KAAK,EAALA,KAAF;cAASc,OAAO,EAAPA,OAAT;cAAkBE,qBAAqB,EAArBA;YAAlB;UAFJ,CAAP;QAID,CAxBkB,CAAnB;QA0BApB,kBAAkB,CAACsC,UAAnB,CAA8B3B,KAA9B,EAAqCyB,UAArC;MACD;IACF,CA/EO;IAgFRG,sBAAsB,EAAE,gCACtB5B,KADsB,EAEtBC,MAFsB,EAGnB;MACHZ,kBAAkB,CAACgC,SAAnB,CAA6BrB,KAA7B,EAAoC;QAClCI,EAAE,EAAEH,MAAM,CAACC,OAAP,CAAeE,EADe;QAElCkB,OAAO,EAAE;UACPO,mBAAmB,EAAE5B,MAAM,CAACC,OAAP,CAAe4B;QAD7B;MAFyB,CAApC;IAMD;EA1FO;AAHyB,CAAD,CAApC;AAiGO,4BACLpC,gBAAgB,CAACqC,OADZ;AAAA,IAAQhC,eAAR,yBAAQA,eAAR;AAAA,IAAyB6B,sBAAzB,yBAAyBA,sBAAzB;;;AAGA,4BAGHvC,kBAAkB,CAAC2C,YAAnB,CAAgC,UAAChC,KAAD;EAAA,OAAkBA,KAAK,CAACiC,WAAxB;AAAA,CAAhC,CAHG;AAAA,IACOC,qBADP,yBACLC,UADK;AAAA,IAEMC,oBAFN,yBAELC,SAFK;;;AAKP,OAAO,IAAMC,yBAAyB,GAAGnD,cAAc,CACrDiD,oBADqD,EAErD,UAACG,YAAD;EAAA,OAAkBA,YAAY,CAACC,MAAb,CAAoB,UAACP,WAAD;IAAA,OAAiBA,WAAW,CAAC1B,OAA7B;EAAA,CAApB,CAAlB;AAAA,CAFqD,CAAhD;AAKP,OAAO,IAAMkC,4BAA4B,GAAGtD,cAAc,CACxDmD,yBADwD,EAExD,UAACC,YAAD;EAAA,OAAkBA,YAAY,CAACb,GAAb,CAAiB,UAACO,WAAD;IAAA,OAAiBA,WAAW,CAAC7B,EAA7B;EAAA,CAAjB,CAAlB;AAAA,CAFwD,CAAnD;AAKP,OAAO,IAAMsC,2BAA2B,GAAGvD,cAAc,CACvDmD,yBADuD,EAEvD,UAACC,YAAD;EAAA,OACEA,YAAY,CAACb,GAAb,CAAiB,UAACO,WAAD;IAAA,OAAkB;MACjC7B,EAAE,EAAE6B,WAAW,CAAC7B,EADiB;MAEjCuC,OAAO,EAAEV,WAAW,CAACU,OAFY;MAGjClD,KAAK,EAAEwC,WAAW,CAACxC,KAHc;MAIjCc,OAAO,EAAE0B,WAAW,CAAC1B,OAJY;MAKjCsB,mBAAmB,EAAEI,WAAW,CAACJ;IALA,CAAlB;EAAA,CAAjB,CADF;AAAA,CAFuD,CAAlD;AAWP,eAAenC,gBAAgB,CAACkD,OAAhC"},"metadata":{},"sourceType":"module"}